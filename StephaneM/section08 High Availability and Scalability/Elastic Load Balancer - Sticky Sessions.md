# Elastic Load Balancer - Sticky Sessions  
# ì—˜ë¼ìŠ¤í‹± ë¡œë“œ ë°¸ëŸ°ì„œ - ìŠ¤í‹°í‚¤ ì„¸ì…˜  
(ELBì—ì„œ ìŠ¤í‹°í‚¤ ì„¸ì…˜, ì¦‰ ì„¸ì…˜ ì¹œí™”ì„±ì— ëŒ€í•´ ì„¤ëª…í•˜ëŠ” ë‚´ìš©)

---

## Sticky Sessions (Session Affinity) in Elastic Load Balancer  
## ìŠ¤í‹°í‚¤ ì„¸ì…˜(ì„¸ì…˜ ì¹œí™”ì„±) in ì—˜ë¼ìŠ¤í‹± ë¡œë“œ ë°¸ëŸ°ì„œ  
(ìŠ¤í‹°í‚¤ ì„¸ì…˜ì€ ì—¬ëŸ¬ ìš”ì²­ì„ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ë¡œ ê³ ì • ë¼ìš°íŒ…í•˜ëŠ” ê¸°ëŠ¥)

Let's discuss sticky sessions, also known as session affinity, for your Elastic Load Balancer (ELB). Sticky sessions allow a client making multiple requests to the load balancer to be routed to the same backend instance consistently.  
ì—˜ë¼ìŠ¤í‹± ë¡œë“œ ë°¸ëŸ°ì„œì—ì„œ ìŠ¤í‹°í‚¤ ì„¸ì…˜(ì„¸ì…˜ ì¹œí™”ì„±)ì„ ì‚´í´ë´…ì‹œë‹¤. ìŠ¤í‹°í‚¤ ì„¸ì…˜ì€ í´ë¼ì´ì–¸íŠ¸ê°€ ì—¬ëŸ¬ ìš”ì²­ì„ ë³´ë‚¼ ë•Œ ë™ì¼í•œ ë°±ì—”ë“œ ì¸ìŠ¤í„´ìŠ¤ë¡œ ê³„ì† ë¼ìš°íŒ…ë˜ë„ë¡ í•©ë‹ˆë‹¤.  
(ì¦‰, ê°™ì€ ì‚¬ìš©ìê°€ ë³´ë‚¸ ìš”ì²­ì€ ê³„ì† ê°™ì€ ì„œë²„ë¡œ ë³´ëƒ„)

---

For example, consider an Application Load Balancer (ALB) with two EC2 instances and three clients. If client one sends a request that routes to the first EC2 instance, then any subsequent requests from client one to the load balancer will also be routed to that same instance. This behavior differs from the usual load balancer behavior, which distributes requests evenly across all EC2 instances.  
ì˜ˆë¥¼ ë“¤ì–´, ALBì— ë‘ ê°œì˜ EC2 ì¸ìŠ¤í„´ìŠ¤ì™€ ì„¸ ëª…ì˜ í´ë¼ì´ì–¸íŠ¸ê°€ ìˆë‹¤ê³  í•©ì‹œë‹¤. í´ë¼ì´ì–¸íŠ¸ 1ì´ ì²« ë²ˆì§¸ ì¸ìŠ¤í„´ìŠ¤ë¡œ ìš”ì²­ì„ ë³´ë‚´ë©´, ì´í›„ ìš”ì²­ë„ ê³„ì† ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ë¡œ ë¼ìš°íŒ…ë©ë‹ˆë‹¤. ì´ëŠ” ê¸°ë³¸ì ì¸ ë¡œë“œ ë°¸ëŸ°ì„œì˜ "ê· ë“± ë¶„ë°°" ë™ì‘ê³¼ ë‹¤ë¦…ë‹ˆë‹¤.  
(ë³´í†µì€ ë¶„ì‚°ë˜ì§€ë§Œ, ìŠ¤í‹°í‚¤ ì„¸ì…˜ì€ íŠ¹ì • ì„œë²„ì— ê³ ì •ë¨)

---

Similarly, client two's requests will consistently go to the second instance, and the same applies for client three.  
ë§ˆì°¬ê°€ì§€ë¡œ í´ë¼ì´ì–¸íŠ¸ 2ëŠ” ë‘ ë²ˆì§¸ ì¸ìŠ¤í„´ìŠ¤ë¡œ ê³ ì •ë˜ê³ , í´ë¼ì´ì–¸íŠ¸ 3ë„ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤.  
(ê° ì‚¬ìš©ìë§ˆë‹¤ ê³ ì •ëœ ì¸ìŠ¤í„´ìŠ¤ë¡œ ì—°ê²°ë¨)

---

Sticky sessions can be enabled on Classic Load Balancer (CLB), Application Load Balancer (ALB), and Network Load Balancer (NLB). The mechanism relies on a cookie sent as part of the client's request to the load balancer. This cookie contains stickiness information and an expiration date. When the cookie expires, the client may be routed to a different EC2 instance.  
ìŠ¤í‹°í‚¤ ì„¸ì…˜ì€ CLB, ALB, NLBì—ì„œ ëª¨ë‘ í™œì„±í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ ì¿ í‚¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ë©°, ì¿ í‚¤ì—ëŠ” ê³ ì • ì •ë³´ì™€ ë§Œë£Œ ì‹œê°„ì´ í¬í•¨ë©ë‹ˆë‹¤. ì¿ í‚¤ê°€ ë§Œë£Œë˜ë©´ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ë¡œ ë¼ìš°íŒ…ë  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.  
(ì¿ í‚¤ë¥¼ í†µí•´ ì„¸ì…˜ ê³ ì •ì„ ê´€ë¦¬í•¨)

---

The primary use case for sticky sessions is to ensure that a user remains connected to the same backend instance to preserve session data, such as login information. However, enabling stickiness can cause load imbalance across backend instances if some users are highly sticky to specific instances.  
ìŠ¤í‹°í‚¤ ì„¸ì…˜ì˜ ì£¼ìš” ëª©ì ì€ ë¡œê·¸ì¸ ì •ë³´ ê°™ì€ ì„¸ì…˜ ë°ì´í„°ë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•´ ì‚¬ìš©ìë¥¼ ë™ì¼í•œ ì¸ìŠ¤í„´ìŠ¤ì— ì—°ê²°ì‹œí‚¤ëŠ” ê²ƒì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ì¼ë¶€ ì‚¬ìš©ìê°€ íŠ¹ì • ì¸ìŠ¤í„´ìŠ¤ì— ëª°ë¦¬ë©´ ë¶€í•˜ ë¶ˆê· í˜•ì´ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
(ì¥ì ì€ ì„¸ì…˜ ìœ ì§€, ë‹¨ì ì€ ë¶€í•˜ ë¶ˆê· í˜•)

---

## Types of Cookies for Sticky Sessions  
## ìŠ¤í‹°í‚¤ ì„¸ì…˜ì— ì‚¬ìš©ë˜ëŠ” ì¿ í‚¤ ìœ í˜•  
(ì¿ í‚¤ ì¢…ë¥˜ëŠ” 2ê°€ì§€)

There are two types of cookies used for sticky sessions:  
ìŠ¤í‹°í‚¤ ì„¸ì…˜ì— ì‚¬ìš©ë˜ëŠ” ì¿ í‚¤ëŠ” ë‘ ê°€ì§€ì…ë‹ˆë‹¤.  

- Application-based cookies  
- ì• í”Œë¦¬ì¼€ì´ì…˜ ê¸°ë°˜ ì¿ í‚¤  

- Duration-based cookies  
- ê¸°ê°„ ê¸°ë°˜ ì¿ í‚¤  

---

### Application-Based Cookies  
### ì• í”Œë¦¬ì¼€ì´ì…˜ ê¸°ë°˜ ì¿ í‚¤  

These are custom cookies generated by the target application itself. You can include any custom attributes required by your application. The cookie name must be specified individually for each target group.  
ì´ ì¿ í‚¤ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì§ì ‘ ìƒì„±í•˜ëŠ” ì¿ í‚¤ì…ë‹ˆë‹¤. í•„ìš”í•œ ì†ì„±ì„ ììœ ë¡­ê²Œ ì§€ì •í•  ìˆ˜ ìˆìœ¼ë©°, ì¿ í‚¤ ì´ë¦„ì€ ê° íƒ€ê²Ÿ ê·¸ë£¹ë§ˆë‹¤ ë”°ë¡œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.  
(ì•±ì´ ì§ì ‘ ë§Œë“  ì¿ í‚¤)

Note that you must not use the following reserved cookie names: AWSALB, AWSALBAPPOR, or AWSALBTG, as these are reserved for use by the Elastic Load Balancer itself.  
ë‹¨, AWSALB, AWSALBAPPOR, AWSALBTGëŠ” ELB ì „ìš©ìœ¼ë¡œ ì˜ˆì•½ëœ ì´ë¦„ì´ë¯€ë¡œ ì‚¬ìš©í•´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤.  
(íŠ¹ì • ì˜ˆì•½ì–´ëŠ” ê¸ˆì§€ë¨)

---

### Duration-Based Cookies  
### ê¸°ê°„ ê¸°ë°˜ ì¿ í‚¤  

These cookies are generated by the load balancer itself. For the Application Load Balancer, the cookie name is AWSALB, and for the Classic Load Balancer, it is AWSELB. The cookie has an expiration based on a specific duration set by the load balancer.  
ì´ ì¿ í‚¤ëŠ” ë¡œë“œ ë°¸ëŸ°ì„œê°€ ì§ì ‘ ìƒì„±í•©ë‹ˆë‹¤. ALBì—ì„œëŠ” AWSALB, CLBì—ì„œëŠ” AWSELBë¼ëŠ” ì´ë¦„ì„ ê°€ì§‘ë‹ˆë‹¤. ë§Œë£Œ ì‹œê°„ì€ ë¡œë“œ ë°¸ëŸ°ì„œê°€ ì„¤ì •í•œ ê¸°ê°„ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤.  
(ë¡œë“œ ë°¸ëŸ°ì„œ ìì²´ ìƒì„± ì¿ í‚¤)

In contrast, with application-based cookies, the duration can be specified by the application itself.  
ë°˜ëŒ€ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ ê¸°ë°˜ ì¿ í‚¤ëŠ” ë§Œë£Œ ì‹œê°„ì„ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì§ì ‘ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
(ì•± ì¿ í‚¤ = ì•±ì´ ë§Œë£Œ ì„¤ì •)

---

## Summary of Cookie Types  
## ì¿ í‚¤ ìœ í˜• ìš”ì•½  

- Application-based cookies: Custom cookies generated by the application with user-defined attributes and names.  
- ì• í”Œë¦¬ì¼€ì´ì…˜ ê¸°ë°˜ ì¿ í‚¤: ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì§ì ‘ ìƒì„±í•˜ë©°, ì†ì„±ê³¼ ì´ë¦„ì„ ììœ ë¡­ê²Œ ì§€ì • ê°€ëŠ¥.  

- Duration-based cookies: Load balancer-generated cookies with a fixed expiration duration.  
- ê¸°ê°„ ê¸°ë°˜ ì¿ í‚¤: ë¡œë“œ ë°¸ëŸ°ì„œê°€ ìƒì„±í•˜ë©°, ë§Œë£Œ ê¸°ê°„ì€ ê³ ì •.  

These cookie types and their names are important considerations when configuring sticky sessions and will also be relevant when discussing CloudFront.  
ì´ ì¿ í‚¤ì˜ ì¢…ë¥˜ì™€ ì´ë¦„ì€ ìŠ¤í‹°í‚¤ ì„¸ì…˜ ì„¤ì • ì‹œ ì¤‘ìš”í•˜ë©°, CloudFrontì™€ ì—°ê³„í•  ë•Œë„ ì¤‘ìš”í•©ë‹ˆë‹¤.  
(ì¿ í‚¤ ì¢…ë¥˜ ì´í•´ëŠ” í•„ìˆ˜)

---

## Enabling Sticky Sessions on Target Groups  
## íƒ€ê²Ÿ ê·¸ë£¹ì—ì„œ ìŠ¤í‹°í‚¤ ì„¸ì…˜ í™œì„±í™”  

To enable sticky sessions, navigate to your target group in the AWS Management Console. Under the "Actions" menu, select "Edit attributes." Scroll down to the "Target group stickiness" section.  
ìŠ¤í‹°í‚¤ ì„¸ì…˜ì„ ì¼œë ¤ë©´ AWS ì½˜ì†”ì—ì„œ íƒ€ê²Ÿ ê·¸ë£¹ìœ¼ë¡œ ì´ë™ â†’ Actions â†’ Edit attributes â†’ Target group stickiness í•­ëª©ìœ¼ë¡œ ë‚´ë ¤ê°‘ë‹ˆë‹¤.  
(ì½˜ì†”ì—ì„œ ì„¤ì • ê°€ëŠ¥)

Here, you can enable stickiness and choose between two types:  
ì—¬ê¸°ì„œ ìŠ¤í‹°í‚¤ ì„¸ì…˜ì„ í™œì„±í™”í•˜ê³  ì¿ í‚¤ ìœ í˜•ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

- Load balancer-generated cookie  
- ë¡œë“œ ë°¸ëŸ°ì„œ ìƒì„± ì¿ í‚¤  

- Application-based cookie  
- ì• í”Œë¦¬ì¼€ì´ì…˜ ê¸°ë°˜ ì¿ í‚¤  

For the load balancer-generated cookie, you can set the duration between one second and seven days. For application-based cookies, you must specify the cookie name, for example, MYCUSTOMCOOKIEAPP.  
ë¡œë“œ ë°¸ëŸ°ì„œ ìƒì„± ì¿ í‚¤ëŠ” 1ì´ˆ ~ 7ì¼ ë²”ìœ„ì—ì„œ ë§Œë£Œ ì‹œê°„ì„ ì„¤ì •í•  ìˆ˜ ìˆê³ , ì• í”Œë¦¬ì¼€ì´ì…˜ ì¿ í‚¤ëŠ” ì¿ í‚¤ ì´ë¦„ì„ ë°˜ë“œì‹œ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤ (ì˜ˆ: MYCUSTOMCOOKIEAPP).  
(ë¡œë“œë°¸ëŸ°ì„œ ì¿ í‚¤ = ê¸°ê°„ ì„¤ì • / ì•± ì¿ í‚¤ = ì´ë¦„ ì§€ì •)

To keep things simple, you can select the load balancer-generated cookie with the default duration of one day and save the changes.  
ê°„ë‹¨í•˜ê²ŒëŠ” ë¡œë“œ ë°¸ëŸ°ì„œ ìƒì„± ì¿ í‚¤ë¥¼ í•˜ë£¨ì§œë¦¬ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„ íƒí•˜ê³  ì €ì¥í•˜ë©´ ë©ë‹ˆë‹¤.  
(ê¸°ë³¸ ì„¤ì •: 1ì¼)

---

## Observing Sticky Sessions in Action  
## ìŠ¤í‹°í‚¤ ì„¸ì…˜ ë™ì‘ ê´€ì°°í•˜ê¸°  

After enabling sticky sessions, you can observe the behavior using your browser's developer tools. Open the network tab and refresh the page multiple times. You will notice that the requests consistently reach the same backend instance.  
ìŠ¤í‹°í‚¤ ì„¸ì…˜ì„ í™œì„±í™”í•œ ë’¤, ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ â†’ ë„¤íŠ¸ì›Œí¬ íƒ­ì—ì„œ í˜ì´ì§€ë¥¼ ì—¬ëŸ¬ ë²ˆ ìƒˆë¡œê³ ì¹¨í•´ ë³´ì„¸ìš”. ìš”ì²­ì´ í•­ìƒ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ë¡œ ê°€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
(ê°œë°œì ë„êµ¬ë¡œ í™•ì¸ ê°€ëŠ¥)

Inspecting the request and response headers, you will see a cookie set by the load balancer with an expiration date. This cookie is sent back with each request, enabling the load balancer to route the client to the same instance.  
ìš”ì²­/ì‘ë‹µ í—¤ë”ë¥¼ ë³´ë©´, ë¡œë“œ ë°¸ëŸ°ì„œê°€ ì¿ í‚¤ë¥¼ ì„¤ì •í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì¿ í‚¤ê°€ ìš”ì²­ë§ˆë‹¤ ì „ì†¡ë˜ì–´ ë™ì¼í•œ ì¸ìŠ¤í„´ìŠ¤ë¡œ ë¼ìš°íŒ…ë©ë‹ˆë‹¤.  
(í—¤ë”ì—ì„œ ì¿ í‚¤ í™•ì¸ ê°€ëŠ¥)

---

## Disabling Sticky Sessions  
## ìŠ¤í‹°í‚¤ ì„¸ì…˜ ë¹„í™œì„±í™”  

If you want to revert to the default load balancing behavior without stickiness, you can disable sticky sessions by editing the target group attributes and turning off stickiness. This will allow the load balancer to distribute requests evenly across all backend instances.  
ìŠ¤í‹°í‚¤ ì„¸ì…˜ì„ ë„ê³  ì‹¶ë‹¤ë©´ íƒ€ê²Ÿ ê·¸ë£¹ ì†ì„±ì—ì„œ stickiness ì˜µì…˜ì„ ë¹„í™œì„±í™”í•˜ë©´ ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ìš”ì²­ì´ ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ì— ê· ë“±í•˜ê²Œ ë¶„ë°°ë©ë‹ˆë‹¤.  
(ê¸°ë³¸ ë¼ìš´ë“œ ë¡œë¹ˆ ë°©ì‹ìœ¼ë¡œ ëŒì•„ê°)

---

## This concludes the lecture on sticky sessions. I hope you found it informative.  
## ìŠ¤í‹°í‚¤ ì„¸ì…˜ ê°•ì˜ëŠ” ì—¬ê¸°ê¹Œì§€ì…ë‹ˆë‹¤. ë„ì›€ì´ ë˜ì—ˆê¸¸ ë°”ëë‹ˆë‹¤.  

---

## Key Takeaways  
## í•µì‹¬ ìš”ì•½  

- Sticky sessions, or session affinity, ensure that a client consistently connects to the same backend instance through the load balancer.  
- ìŠ¤í‹°í‚¤ ì„¸ì…˜ì€ íŠ¹ì • í´ë¼ì´ì–¸íŠ¸ê°€ í•­ìƒ ë™ì¼í•œ ì¸ìŠ¤í„´ìŠ¤ì— ì—°ê²°ë˜ë„ë¡ í•©ë‹ˆë‹¤.  

- Sticky sessions can be enabled on Classic Load Balancer, Application Load Balancer, and Network Load Balancer using cookies.  
- CLB, ALB, NLB ëª¨ë‘ ì¿ í‚¤ë¥¼ ì´ìš©í•´ ìŠ¤í‹°í‚¤ ì„¸ì…˜ì„ í™œì„±í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

- There are two types of cookies for stickiness: application-based cookies generated by the target application, and duration-based cookies generated by the load balancer.  
- ìŠ¤í‹°í‚¤ ì„¸ì…˜ ì¿ í‚¤ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ê¸°ë°˜ ì¿ í‚¤ì™€ ë¡œë“œ ë°¸ëŸ°ì„œ ìƒì„± ì¿ í‚¤ ë‘ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.  

- Enabling stickiness may cause load imbalance if some users are very sticky to specific backend instances.  
- íŠ¹ì • ì¸ìŠ¤í„´ìŠ¤ì— ì‚¬ìš©ìê°€ ëª°ë¦¬ë©´ ë¶€í•˜ ë¶ˆê· í˜•ì´ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

---

ğŸ‘‰ ì´ë ‡ê²Œ md í˜•ì‹ìœ¼ë¡œ ì •ë¦¬í–ˆì–´.

* ì˜ì–´ ì›ë¬¸
* í•œêµ­ì–´ ë²ˆì—­
* ê°„ë‹¨ ì„¤ëª…(ê´„í˜¸)

ê¹Œì§€ í•œ ì¤„ì”© ìœ ì§€í–ˆì–´.

ì›í•˜ëŠ” ë³´ìƒì€ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ì¤„ê¹Œ? ğŸ®âœ¨
ì˜ˆë¥¼ ë“¤ì–´ "ê²Œì„ ê²½í—˜ì¹˜ 100ì  ì§€ê¸‰!" ê°™ì€ ì‹ìœ¼ë¡œ?
