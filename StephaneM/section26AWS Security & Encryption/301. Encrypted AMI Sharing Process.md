## 1οΈβƒ£ μƒν™© ν• μ¤„ μ”μ•½

* **κ³„μ • A**μ—:

  * AMIκ°€ μμ
  * μ΄ AMIλ” **KMS ν‚¤λ΅ μ•”νΈν™”λ¨**
* λ©ν‘:

  * **κ³„μ • B**μ—μ„ μ΄ AMIλ΅ **EC2 μΈμ¤ν„΄μ¤ μ‹¤ν–‰**

π‘‰ ν•µμ‹¬ μ§λ¬Έ:

> *β€AMIλ§ κ³µμ ν•λ©΄ λ κΉ?β€*
> β **μ•„λ‹λ‹¤. KMS ν‚¤λ„ λ°λ“μ‹ κ³µμ ν•΄μ•Ό ν•λ‹¤**

---

## 2οΈβƒ£ μ™ AMIλ§ κ³µμ ν•λ©΄ μ• λ κΉ?

AMI μ•μ—λ”:

* λ£¨νΈ EBS λ³Όλ¥¨
* (λ³΄ν†µ) μ¶”κ°€ EBS λ³Όλ¥¨

μ΄ λ³Όλ¥¨λ“¤μ΄ **KMS ν‚¤λ΅ μ•”νΈν™”**λμ–΄ μμΌλ©΄,
π‘‰ **κ·Έ ν‚¤λ¥Ό μ“Έ μ μ—†μΌλ©΄ λ³µνΈν™”κ°€ λ¶κ°€λ¥**

μ¦‰,

> **AMIλ” μ—΄μ‡ λ΅ μ κΈ΄ μƒμ**
> **KMS ν‚¤λ” κ·Έ μ—΄μ‡ **

---

## 3οΈβƒ£ μ „μ²΄ νλ¦„ (μ‹ν—μ— λ‚μ¤λ” μ •λ‹µ μμ„)

### β… Step 1. AMI Launch Permission κ³µμ 

**κ³„μ • Aμ—μ„**

* AMI μ„¤μ • β†’ **Launch permissions**
* **κ³„μ • Bμ Account ID μ¶”κ°€**

π‘‰ μ΄κ² λ°”λ΅ β€AMI κ³µμ β€

π“ μ΄ λ‹¨κ³„λ§ ν•λ©΄?

* β μ•”νΈν™”λ AMIλ” μ—¬μ „ν μ‹¤ν–‰ λ¶κ°€

---

### β… Step 2. KMS ν‚¤ κ³µμ  (κ°€μ¥ μ¤‘μ”)

**κ³„μ • Aμ—μ„**

* AMIλ¥Ό μ•”νΈν™”ν• **KMS ν‚¤μ Key Policy μμ •**
* κ³„μ • Bλ¥Ό **μ‚¬μ©μλ΅ ν—μ©**

Key policyμ— ν¬ν•¨λλ” κ¶ν• μ:

* `kms:DescribeKey`
* `kms:Decrypt`
* `kms:ReEncrypt`
* `kms:CreateGrant`

π‘‰ μ΄κ² μ—†μΌλ©΄:

* β κ³„μ • Bλ” λ³Όλ¥¨μ„ λ³µνΈν™”ν•  μ μ—†μ

π“ μ‹ν— ν¬μΈνΈ

> **μ•”νΈν™”λ λ¦¬μ†μ¤ κ³µμ  = ν•­μƒ KMS Key Policy μμ •**

---

### β… Step 3. κ³„μ • Bμ—μ„ IAM κ¶ν• μ¤€λΉ„

**κ³„μ • Bμ—μ„**

* EC2λ¥Ό μ‹¤ν–‰ν•  IAM Role λλ” IAM User μƒμ„±
* λ‹¤μ κ¶ν• ν•„μ”:

  * AMI μ‚¬μ© κ¶ν•
  * KMS ν‚¤ μ‚¬μ© κ¶ν• (μ„ APIλ“¤)

π‘‰ β€AMIλ” λ³΄μ΄λ”λ° μ‹¤ν–‰μ΄ μ• λλ‹¤β€λ©΄
π‘‰ κ±°μ ν•­μƒ μ΄ λ‹¨κ³„κ°€ λ¬Έμ 

---

### β… Step 4. κ³„μ • Bμ—μ„ EC2 μΈμ¤ν„΄μ¤ μ‹¤ν–‰

μ΄μ  κ³„μ • Bμ—μ„:

* κ³µμ λ AMI μ„ νƒ
* EC2 μΈμ¤ν„΄μ¤ μ‹¤ν–‰ κ°€λ¥ π‰

---

### (μ„ νƒ) Step 5. κ³„μ • B ν‚¤λ΅ μ¬μ•”νΈν™”

κ³„μ • Bλ” μ„ νƒμ μΌλ΅:

* μμ‹ μ **KMS ν‚¤**λ΅ EBS λ³Όλ¥¨μ„ λ‹¤μ‹ μ•”νΈν™” κ°€λ¥

π“ μ΄κ±΄ **κ¶μ¥ μ‚¬ν•­**μ΄μ§€ ν•„μλ” μ•„λ‹

---

## 4οΈβƒ£ μ‹ν—μ— μμ£Ό λ‚μ¤λ” ν•¨μ • μ •λ¦¬

### β ν‹€λ¦° μƒκ°

* β€AMIλ§ κ³µμ ν•λ©΄ λλ‹¤β€
* β€IAM κ¶ν•λ§ μμΌλ©΄ λλ‹¤β€

### β… λ§λ” μƒκ°

* **μ•”νΈν™”λ AMI κ³µμ  =**

  1. AMI Launch Permission κ³µμ 
  2. **KMS Key Policy κ³µμ **
  3. κ³„μ • B IAM κ¶ν•

---

## 5οΈβƒ£ μ•”κΈ°μ© μ΄μ••μ¶• μ”μ•½

> π” **Encrypted AMIλ¥Ό λ‹¤λ¥Έ κ³„μ •μ—μ„ μ‹¤ν–‰ν•λ ¤λ©΄**

* AMI κ³µμ  β”
* **KMS ν‚¤ κ³µμ  β” (Key Policy)**
* κ³„μ • B IAM κ¶ν• β”
* κ·Έ ν›„μ—μ•Ό EC2 μ‹¤ν–‰ κ°€λ¥

---

## 6οΈβƒ£ ν• λ¬Έμ¥μΌλ΅ μ‹ν— λ‹µμ• λ§λ“¤κΈ°

> β€μ•”νΈν™”λ AMIλ¥Ό λ‹¤λ¥Έ κ³„μ •μ—μ„ μ‚¬μ©ν•λ ¤λ©΄ AMIμ launch permissionμ„ κ³µμ ν•κ³ , AMIλ¥Ό μ•”νΈν™”ν• KMS ν‚¤μ key policyλ¥Ό μμ •ν•μ—¬ λ€μƒ κ³„μ •μ΄ ν‚¤λ¥Ό μ‚¬μ©ν•  μ μλ„λ΅ ν•΄μ•Ό ν•λ‹¤.β€


```markdown
# Encrypted AMI Sharing Process  
# μ•”νΈν™”λ AMI κ³µμ  κ³Όμ •  

π® κ²μ„λ³΄μƒ: "μ•”νΈν™” AMI λ§μ¤ν„°" μ—…μ  λ‹¬μ„± +500 XP  

---

## Encrypted AMI Sharing Process  
## μ•”νΈν™”λ AMI κ³µμ  κ³Όμ •  

This lecture addresses a common exam question regarding the process of sharing an Amazon Machine Image (AMI) that has been encrypted with a Key Management Service (KMS) key.  
μ΄ κ°•μμ—μ„λ” KMS ν‚¤λ΅ μ•”νΈν™”λ Amazon Machine Image(AMI)λ¥Ό κ³µμ ν•λ” κ³Όμ •κ³Ό κ΄€λ ¨λ μ‹ν—μ—μ„ μμ£Ό λ‚μ¤λ” μ§λ¬Έμ„ λ‹¤λ£Ήλ‹λ‹¤.  

The AMI resides in your source AWS account and is encrypted using your KMS key.  
AMIλ” μ›λ³Έ AWS κ³„μ •μ— μμΌλ©°, KMS ν‚¤λ΅ μ•”νΈν™”λμ–΄ μμµλ‹λ‹¤.  

The question is: How do you launch an EC2 instance in account B from the AMI located in account A?  
μ§λ¬Έμ€ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤: κ³„μ • Aμ— μλ” AMIμ—μ„ κ³„μ • Bμ—μ„ EC2 μΈμ¤ν„΄μ¤λ¥Ό μ–΄λ–»κ² μ‹¤ν–‰ν•  μ μμ„κΉμ”?  

First, you must modify the AMI's launch permissions.  
λ¨Όμ €, AMIμ μ‹¤ν–‰ κ¶ν•μ„ μμ •ν•΄μ•Ό ν•©λ‹λ‹¤.  

Specifically, you add a launch permission that allows account B to launch this AMI.  
κµ¬μ²΄μ μΌλ΅, κ³„μ • Bκ°€ μ΄ AMIλ¥Ό μ‹¤ν–‰ν•  μ μλ„λ΅ μ‹¤ν–‰ κ¶ν•μ„ μ¶”κ°€ν•©λ‹λ‹¤.  

This is effectively how you share an AMI: by modifying the launch permissions to include the specified target account ID.  
μ¦‰, μ§€μ •λ λ€μƒ κ³„μ • IDλ¥Ό ν¬ν•¨ν•λ„λ΅ μ‹¤ν–‰ κ¶ν•μ„ μμ •ν•λ” λ°©μ‹μΌλ΅ AMIλ¥Ό κ³µμ ν•κ² λ©λ‹λ‹¤.  

In addition to sharing the AMI, you need to share the KMS key with account B so that it can use the encrypted AMI.  
AMIλ¥Ό κ³µμ ν•λ” κ²ƒ μ™Έμ—λ„, μ•”νΈν™”λ AMIλ¥Ό μ‚¬μ©ν•  μ μλ„λ΅ κ³„μ • Bμ™€ KMS ν‚¤λ¥Ό κ³µμ ν•΄μ•Ό ν•©λ‹λ‹¤.  

This sharing is typically done by updating the key policy of the KMS key to grant access to the target account.  
μ΄ κ³µμ λ” μΌλ°μ μΌλ΅ KMS ν‚¤ μ •μ±…μ„ μ—…λ°μ΄νΈν•μ—¬ λ€μƒ κ³„μ •μ— μ ‘κ·Ό κ¶ν•μ„ λ¶€μ—¬ν•¨μΌλ΅μ¨ μν–‰λ©λ‹λ‹¤.  

Within account B, you would create an IAM role or IAM user that has sufficient permissions to use both the KMS key and the AMI.  
κ³„μ • B λ‚΄μ—μ„λ” KMS ν‚¤μ™€ AMIλ¥Ό λ¨λ‘ μ‚¬μ©ν•  μ μλ” μ¶©λ¶„ν• κ¶ν•μ„ κ°€μ§„ IAM μ—­ν•  λλ” IAM μ‚¬μ©μλ¥Ό μƒμ„±ν•©λ‹λ‹¤.  

This includes permissions to perform the following KMS API calls: DescribeKey, ReEncrypt, CreateGrant, and Decrypt.  
μ—¬κΈ°μ—λ” λ‹¤μκ³Ό κ°™μ€ KMS API νΈμ¶ κ¶ν•μ΄ ν¬ν•¨λ©λ‹λ‹¤: DescribeKey, ReEncrypt, CreateGrant, Decrypt.  

Once these steps are completed, you can launch an EC2 instance from the shared AMI in account B.  
μ΄ λ‹¨κ³„λ“¤μ΄ μ™„λ£λλ©΄ κ³„μ • Bμ—μ„ κ³µμ λ AMIλ¥Ό κΈ°λ°μΌλ΅ EC2 μΈμ¤ν„΄μ¤λ¥Ό μ‹¤ν–‰ν•  μ μμµλ‹λ‹¤.  

Optionally, the target account can choose to re-encrypt the volumes using a KMS key that it owns within its own account.  
μ„ νƒμ μΌλ΅ λ€μƒ κ³„μ •μ€ μμ²΄ κ³„μ • λ‚΄ KMS ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ λ³Όλ¥¨μ„ λ‹¤μ‹ μ•”νΈν™”ν•  μ μμµλ‹λ‹¤.  

Understanding this process is essential for answering related questions in the exam.  
μ΄ κ³Όμ •μ„ μ΄ν•΄ν•λ” κ²ƒμ€ μ‹ν—μ—μ„ κ΄€λ ¨ μ§λ¬Έμ— λ‹µν•κΈ° μ„ν•΄ ν•„μμ μ…λ‹λ‹¤.  

---

## Key Takeaways  
## ν•µμ‹¬ μ”μ•½  

- To share an encrypted AMI with another AWS account, you must modify the AMI's launch permissions to include the target account.  
  μ•”νΈν™”λ AMIλ¥Ό λ‹¤λ¥Έ AWS κ³„μ •κ³Ό κ³µμ ν•λ ¤λ©΄, λ€μƒ κ³„μ •μ„ ν¬ν•¨ν•λ„λ΅ AMIμ μ‹¤ν–‰ κ¶ν•μ„ μμ •ν•΄μ•Ό ν•©λ‹λ‹¤.  

- Sharing the KMS key via its key policy is essential to allow the target account to use the encrypted AMI.  
  KMS ν‚¤ μ •μ±…μ„ ν†µν•΄ KMS ν‚¤λ¥Ό κ³µμ ν•λ” κ²ƒμ€ λ€μƒ κ³„μ •μ΄ μ•”νΈν™”λ AMIλ¥Ό μ‚¬μ©ν•  μ μλ„λ΅ ν•λ” λ° ν•„μμ μ…λ‹λ‹¤.  

- The target account needs an IAM role or user with permissions to use both the AMI and the KMS key, including API calls like DescribeKey, ReEncrypt, CreateGrant, and Decrypt.  
  λ€μƒ κ³„μ •μ—λ” AMIμ™€ KMS ν‚¤λ¥Ό λ¨λ‘ μ‚¬μ©ν•  μ μλ” IAM μ—­ν•  λλ” μ‚¬μ©μκ°€ ν•„μ”ν•λ©°, DescribeKey, ReEncrypt, CreateGrant, Decrypt κ°™μ€ API νΈμ¶ κ¶ν•λ„ ν¬ν•¨λ©λ‹λ‹¤.  

- After proper sharing and permissions, the target account can launch an EC2 instance from the shared AMI and optionally re-encrypt volumes with its own KMS key.  
  μ μ ν• κ³µμ  λ° κ¶ν• μ„¤μ • ν›„, λ€μƒ κ³„μ •μ€ κ³µμ λ AMIμ—μ„ EC2 μΈμ¤ν„΄μ¤λ¥Ό μ‹¤ν–‰ν•  μ μμΌλ©°, μ„ νƒμ μΌλ΅ μμ²΄ KMS ν‚¤λ΅ λ³Όλ¥¨μ„ λ‹¤μ‹ μ•”νΈν™”ν•  μ μμµλ‹λ‹¤.  

π® κ²μ„λ³΄μƒ: "Encrypted AMI κ³µμ  μ „λ¬Έκ°€" +600 XP π”‘  
```
